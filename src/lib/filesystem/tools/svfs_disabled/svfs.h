/*
  * Generated by cppsrc.sh
  * On 
  * by Paweu
*/
/*--END OF HEADER BLOCK--*/

#pragma once
#ifndef LuaVFS_H
#define LuaVFS_H

#include <iostream>
#include <memory>
#include "luainterface.h"

#include "../core/nStarVFS.h"
#include "../core/Module/RemoteModule.h"

class SVFS : public ::StarVFS::StarVFS {
public:
	SVFS(SharedLua Lua);
 	~SVFS();

	bool Initialize();

	void StartServer(const char* port) { AddModule<::StarVFS::Modules::RemoteModule>(port); }
private:
	SharedLua m_Lua;

	int RawOpenContainer(const char *what, const char * where) {
		return (int)OpenContainer(what, where ? where : "/");
	}

    int RawCreateContainer(lua_State *lua);

	bool RawForcePath(const char* path) const {
		return false;
	}

	::StarVFS::FileHandle RawOpenFile(const char* FileName, int ReadMode = (int)::StarVFS::RWMode::R, int FileMode = (int)::StarVFS::OpenMode::OpenExisting) {
		if (!FileName)
			return ::StarVFS::FileHandle();
		return OpenFile(FileName, (::StarVFS::RWMode)ReadMode, (::StarVFS::OpenMode)FileMode);
	}

	const char* RawGetFileName(int fid) const { return GetFileName((::StarVFS::FileID)fid); }
    int RawIsFileDirectory(int fid) const { return IsFileDirectory((::StarVFS::FileID)fid) ? 1 : 0; }
    int RawFindFile(const char *f) { return FindFile(f); }
	
	void CoutDumpStructure() const { DumpStructure(std::cout); }
	void CoutDumpFileTable() const { DumpFileTable(std::cout); }
	void CoutDumpHashTable() const { DumpHashTable(std::cout); }

};

#endif
