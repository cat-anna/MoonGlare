/*
	Generated by cppsrc.sh
	On 2014-12-16  6:13:04,05
	by Paweu
*/

#pragma once
#ifndef Bitmap_H
#define Bitmap_H

namespace MoonGlare {
namespace Modules {
namespace BitmapFont {

using namespace DataClasses::Fonts;

class BitmapFontWrapper : public Wrapper {
	GABI_DECLARE_STATIC_CLASS(BitmapFontWrapper, Wrapper);
	DISABLE_COPY();
	friend class BitmapFont;
public:
	BitmapFontWrapper(const BitmapFont *font);
	~BitmapFontWrapper();

	void Render(Graphic::cRenderDevice &dev);
	void RenderMesh(Graphic::cRenderDevice &dev);
protected:
	Graphic::vec3 m_Color;
	Graphic::VAO m_VAO;
	Graphic::VAO::MeshVector m_Meshes;
	const TextureFile &m_Texture;
	const BitmapFont *m_font;
};

class BitmapFont : public iFont {
	GABI_DECLARE_CLASS(BitmapFont, iFont);
public:
	BitmapFont(const string& Name);
	~BitmapFont();

	FontInstance GenerateInstance(const wstring &text, const Descriptor *style = nullptr) const override;

	float GetHeight() const { return (float)m_BFD.CharHeight; }
	const TextureFile& GetTexture() const { return m_Texture; }
protected:
	class cBFDHeader {
	public:
		cBFDHeader();
		unsigned Width, Height, CharWidth, CharHeight;
		unsigned char BeginingKey, KeyWidths[256];
	};

	//cTexture *TexResource;
	TextureFile m_Texture;
	cBFDHeader m_BFD;
	string m_TextureFile;
	string m_BfdFile;

	virtual bool DoInitialize() override;
	virtual bool DoFinalize() override;
};

} //namespace BitmapFont 
} //namespace Modules 
} //namespace MoonGlare 

#endif
