/*
  * Generated by cppsrc.sh
  * On 2015-03-24 17:52:31,03
  * by Paweu
*/
/*--END OF HEADER BLOCK--*/
#include <pch.h>
#include <MoonGlare.h>
#include "ScriptProxy.h"

namespace Core {
namespace Scripts {

using ::OrbitLogger::ThreadInfo;

thread_local ScriptProxy *ScriptProxy::_Instance = nullptr;
SPACERTTI_IMPLEMENT_STATIC_CLASS(ScriptProxy);

ScriptProxy::ScriptProxy():
		BaseClass(),
		m_Script() {
	if (_Instance) {
		AddLog(Error, "Thread already has script proxy set!");
		return;
	}
	_Instance = this;
	AddLog(Debug, "Thread initialized script proxy instance!");
}

ScriptProxy::~ScriptProxy() {
	if (_Instance && _Instance != this)
		return;
	_Instance = nullptr;
	m_Script.reset();
	AddLog(Debug, "Thread finalized script proxy instance!");
}

//---------------------------------------------------------------------------------------

bool ScriptProxy::RunTimeInitialze() {
	return ::MoonGlare::Core::GetScriptEngine()->InitializeScriptProxy(*this, m_Script);
}

} //namespace Scripts 
} //namespace Core 
