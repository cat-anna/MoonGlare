/*
  * Generated by cppsrc.sh
  * On 2015-08-04 16:59:00,99
  * by Paweu
*/
/*--END OF HEADER BLOCK--*/

#pragma once
#ifndef EntityManager_H
#define EntityManager_H

namespace MoonGlare {
namespace Core {

class EntityManager final 
	: public Config::Current::DebugMemoryInterface {
public:
	struct Memory {
		template<class T> using Array = std::array<T, Configuration::Storage::Static::EntityStorage>;

		template<class ... ARGS>
		using GenerationsAllocator_t = Space::Memory::StaticMultiAllocator<Configuration::Storage::Static::ObjectBuffer, ARGS...>;
		using Generations_t = Space::Memory::GenerationRandomAllocator<GenerationsAllocator_t, Entity>;

		Array<Entity> m_Parent;
		Generations_t m_Allocator;

		template<class T>
		Memory(T t): m_Allocator(t){ }
	};

	EntityManager();
	~EntityManager();

	bool Initialize();
	bool Finalize();

	Entity GetRootEntity() { return m_Root; }

	Entity Allocate();
	Entity Allocate(Entity parent);
	void Release(Entity entity);

	Entity GetParent(Entity entity) const;
	bool IsValid(Entity entity) const;
private: 
	Entity m_Root;
	Memory m_Memory;
};

} //namespace Core 
} //namespace MoonGlare 

#endif
