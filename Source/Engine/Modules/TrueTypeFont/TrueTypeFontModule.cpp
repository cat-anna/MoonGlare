/*
  * Generated by cppsrc.sh
  * On 2015-05-26 18:55:35,14
  * by Paweu
*/
/*--END OF HEADER BLOCK--*/
#include <pch.h>
#include <nfMoonGlare.h>
#include <Engine/DataClasses/iFont.h>
#include <Engine/Modules/ModuleManager.h>
#include "FreeTypeHelper.h"
#include "TrueTypeFont.h"

namespace MoonGlare {
namespace Modules {
namespace TrueTypeFont {

FT_Library ftlib = nullptr;
	 
struct TrueTypeFontModule : public MoonGlare::Modules::ModuleInfo {
	TrueTypeFontModule(): 
			BaseClass("TrueTypeFont") { 
	}

	bool Initialize() override {
		auto error = FT_Init_FreeType( &ftlib );
		if ( error ) {
			AddLogf(Error, "Unable to initialize FreeType library. Code: %d", error);
			return false;
		}

		FT_Int major, minor, patch;
		FT_Library_Version(ftlib, &major, &minor, &patch);

		AddLogf(System, "FreeType version: %d.%d.%d", major, minor, patch);
		FontClassRegister::Register<TrueTypeFont> ClassReg;

		return true;
	}

	bool Finalize() override {
		auto error = FT_Done_Library(ftlib);
		if ( error ) {
			AddLogf(Error, "Unable to finalize FreeType library. Code: %d", error);
			return false;
		}
		return true;
	}
};

DEFINE_MODULE(TrueTypeFontModule);

} //namespace TrueTypeFont 
} //namespace Modules 
} //namespace MoonGlare 
